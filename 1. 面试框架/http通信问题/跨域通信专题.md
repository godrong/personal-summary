### 跨域通信 
CORS 是一个 W3C 标准，全称是“跨域资源共享”（Cross-origin resource sharing）。它允许浏览器向跨域的服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。
#### 1.简介
CORS需要浏览器和服务器同时支撑。目前所有的浏览器都支持该功能。
整个 CORS 通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS 通信与普通的 AJAX 通信没有差别，代码完全一样。浏览器一旦发现 AJAX 请求跨域，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感知。因此，实现 CORS 通信的关键是服务器。只要服务器实现了 CORS 接口，就可以跨域通信。
#### 2.同源策略 
同源策略：限制从一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的关键的安全机制。（来自MDN官方的解释）
1.  一个源由协议、域名、端口组成
2.  同源策略限制从一个源加载的文档或脚本与来自另一个源的资源进行交互
3.  具体限制   
    3.1 Cookie、localStorage、 IndexDB无法获取
    3.2 DOM无法获取
    3.3 AJAX不能发送 
##### CROS请求分为两类 
   1. 简单请求 HEAD POST GET
   2. HTTP 的头信息不超出以下几种字段。
        Accept
        Accept-Language
        Content-Language
        Last-Event-ID
        Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain
    添加Origin字段，本次请求来自哪个域，




### 跨域通信的几种方式
    1. JSONP
        JSONP的原理 ：通过<script>标签的异步加载实现的，head标签里，可以通过<script>标签里的src,里面放
        url，加载很多在线的插件，这就是用到了JSONP。
    2. WebSocket

#### 3. CORS
            跨域资源共享
##### 3.1 与 JSONP 的比较 # 
            CORS 与 JSONP 的使用目的相同，但是比 JSONP 更强大。JSONP 只支持GET请求，CORS 支持所有类型的 HTTP 请求。JSONP 的优势在于支持老式浏览器，以及可以向不支持 CORS 的网站请求数据。
    4. Hash
    5. postMessage 
        PostMessage 是 html5 新引进的一个可跨源通信 api，你可以通过这个 api，让主页面和任意 frame 类页面或 window.open 打开的页面进行双向通信。
        父页面通过API方法message注册监听事件，子页面接收到监听信息后，开始注册事件，发送信息到window对象，
        传递给父页面监听的messgae事件。
            5.1 信息传递安全问题。为了你的信息传递能准确传达，无论是作为主页面还是子页面，传递重要信息时都应该填写 origin 而不是 “*”，避免被截获。
            5.2 iframe 或者 window.open 的 load 事件是不准确的。为了避免漏发漏接的情况，建议在通讯页面里回传加载状态。



https://zhuanlan.zhihu.com/p/115641184
https://wangdoc.com/javascript/bom/cors.html

